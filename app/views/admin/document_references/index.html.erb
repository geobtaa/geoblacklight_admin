<%- @page_title = "GBLâ™¦Admin - Document - Download Links" %>

<div class="row mb-2">
  <div class="col">
    <h1 style="width:100%;">
      Document &middot; References

      <% if params[:document_id] %>
        <%= link_to '+ Import CSV', import_admin_document_document_references_path(@document), { class: 'btn btn-primary float-right' } %>

        <%= link_to '+ New Reference', new_admin_document_document_reference_path(@document), { class: 'btn btn-primary float-right mr-2' } %>
      <% else %>
        <%= link_to '- Delete CSV', destroy_all_admin_document_references_path, { class: 'btn btn-danger float-right' } %>
        <%= link_to '+ Import CSV', import_admin_document_references_path, { class: 'btn btn-primary float-right mr-4' } %>
      <% end %>
    </h1>
    <% if params[:document_id] %>
      <h2 class='h3'>
        <%= link_to(@document.title, admin_document_path(@document)) %>
        &middot;
        <%= @document_references.count %> references
      </h2>
    <% else %>
      <h2 class='h3'>References</h2>
    <% end %>

    <% if @pagy %>
    <h6>
      <span class='float-left mt-3'>
        <%== pagy_info(@pagy) %>
      </span>
      <span class='float-right'>
        <%== pagy_bootstrap_nav(@pagy) %>
      </span>
    </h6>
    <% end %>

    <table class="table table-striped table-bordered sortable">
      <thead class="thead-dark">
        <tr>
          <th class="header">Layer Slug</th>
          <th class="header">Type</th>
          <th class="header">URI</th>
          <th class="header">Value</th>
          <th class="header">Label</th>
          <th class="header" colspan="2">Actions</th>
        </tr>
      </thead>

      <tbody>
        <% @document_references.each do |document_reference| %>
          <tr>
            <td><%= link_to document_reference.friendlier_id, admin_document_path(document_reference.document) %></td>
            <td><%= document_reference.reference_type.reference_type %></td>
            <td><%= document_reference.reference_type.reference_uri %></td>
            <td><%= link_to document_reference.url, document_reference.url, target: '_blank' %></td>
            <td><%= document_reference.label %></td>
            <td><%= link_to 'Edit', edit_admin_document_document_reference_path(document_reference.document, document_reference) %></td>
            <td><%= link_to 'Destroy', admin_document_document_reference_path(document_reference.document, document_reference), method: :delete, data: { confirm: 'Are you sure?' } %></td>
          </tr>
        <% end %>
      </tbody>
    </table>

    <% if @pagy %>
    <h6>
      <span class='float-left mt-3'>
        <%== pagy_info(@pagy) %>
      </span>
      <span class='float-right'>
        <%== pagy_bootstrap_nav(@pagy) %>
      </span>
    </h6>
    <% end %>
  </div>
</div>